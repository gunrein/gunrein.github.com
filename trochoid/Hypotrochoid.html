<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Hypotrochoid</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Hypotrochoid=function(elm){var N=Elm.Native,_N=N.Utils(elm),_L=N.List(elm),_E=N.Error(elm),_str=N.JavaScript(elm).toString,$op={},_=Elm.Text(elm),Text=_,hiding={link:1,color:1,height:1};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Prelude(elm),Prelude=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Signal(elm),Signal=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.List(elm),List=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Maybe(elm),Maybe=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Time(elm),Time=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Graphics.Element(elm),Graphics=Graphics||{};Graphics.Element=_;var hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Color(elm),Color=_,hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Graphics.Collage(elm),Graphics=Graphics||{};Graphics.Collage=_;var hiding={};for(var k in _){if(k in hiding)continue;eval('var '+k+'=_["'+k+'"]')};var _=Elm.Window(elm),Window=_,Input_3=F2(function(a1,a2){return {ctor:"Input",_0:a1,_1:a2}}),UserInput_0=F7(function(maxSize_15,guideR_16,rollerR_17,distance_18,thetaSize_19,speed_20,lineColor_21){return {_:{},distance:distance_18,guideR:guideR_16,lineColor:lineColor_21,maxSize:maxSize_15,rollerR:rollerR_17,speed:speed_20,thetaSize:thetaSize_19}}),CircleSegment_4=F2(function(size_22,offset_23){return {_:{},offset:offset_23,size:size_22}}),GameState_5=F3(function(segment_24,curvePath_25,userInput_26){return {_:{},curvePath:curvePath_25,segment:segment_24,userInput:userInput_26}}),stepGame_7=F2(function(_106000_27,gameState_28){return function(){switch(_106000_27.ctor){case'Input':return function(){var size_31=gameState_28.segment.size,offset_32=gameState_28.segment.offset,totalDelta_33=(_106000_27._0*_106000_27._1.speed),atMaxSize_34=(_N.cmp(size_31,_106000_27._1.maxSize).ctor!=='LT'),posEq_35=A3(posEquation_9,_106000_27._1.guideR,_106000_27._1.rollerR,_106000_27._1.distance),genThetas_36=A3(generateThetas_8,size_31,offset_32,_106000_27._1.thetaSize),curvePath_37=A2(map,posEq_35,genThetas_36);return {_:{},curvePath:curvePath_37,segment:{_:{},offset:(atMaxSize_34?(offset_32+totalDelta_33):offset_32),size:(not(atMaxSize_34)?(size_31+totalDelta_33):size_31)},userInput:_106000_27._1}}()};_E.Case('Line 83, Column 3')}()}),generateThetas_8=F3(function(size_38,offset_39,thetaSize_40){return function(){var numAngles_41=ceiling((size_38/thetaSize_40));return A2(map,function(x_42){return(offset_39+(toFloat(x_42)*thetaSize_40))},_L.range(0,numAngles_41))}()}),posEquation_9=F4(function(guideRadius_43,rollingRadius_44,d_45,theta_46){return function(){var radiusDiff_47=(guideRadius_43-rollingRadius_44),thetaRatio_48=((radiusDiff_47/rollingRadius_44)*theta_46);return {ctor:"Tuple2",_0:((radiusDiff_47*cos(theta_46))+(d_45*cos(thetaRatio_48))),_1:((radiusDiff_47*sin(theta_46))-(d_45*sin(thetaRatio_48)))}}()}),display_10=F2(function(_141000_49,gameState_50){return function(){switch(_141000_49.ctor){case'Tuple2':return function(){var curvePath_53=gameState_50.curvePath,lineColor_54=gameState_50.userInput.lineColor,x_55=(toFloat(_141000_49._0)/2.0),y_56=(toFloat(_141000_49._1)/2.0);return A3(collage,x_55,y_56,_L.Cons(A2(traced,solid(lineColor_54),path(curvePath_53)),_L.Nil))}()};_E.Case('Line 135, Column 3')}()}),parameters_1={_:{},distance:30,guideR:60,lineColor:red,maxSize:(1.97*pi),rollerR:6,speed:(pi/1800.0),thetaSize:(pi/180.0)},userInput_2=constant(parameters_1),defaultGame_6={_:{},curvePath:_L.Nil,segment:{_:{},offset:0.0,size:0.0},userInput:parameters_1},delta_11=fps(30),input_12=A2(sampleOn,delta_11,A3(lift2,Input_3,delta_11,userInput_2)),gameState_13=A3(foldp,stepGame_7,defaultGame_6,input_12),main_14=A3(lift2,display_10,Window.dimensions,gameState_13);elm.Native=elm.Native||{};var _=elm.Native.Hypotrochoid||{};_.$op={};_.UserInput=UserInput_0;_.parameters=parameters_1;_.userInput=userInput_2;_.Input=Input_3;_.CircleSegment=CircleSegment_4;_.GameState=GameState_5;_.defaultGame=defaultGame_6;_.stepGame=stepGame_7;_.generateThetas=generateThetas_8;_.posEquation=posEquation_9;_.display=display_10;_.delta=delta_11;_.input=input_12;_.gameState=gameState_13;_.main=main_14;return elm.Hypotrochoid=_}</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Hypotrochoid)</script><noscript></noscript></body></html>